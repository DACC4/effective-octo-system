sequenceDiagram
    actor C as Client
    participant S as Server

    C->>S: Request login for username
    S-->>C: Send encrypted private key, salt, and public key

    C->>C: Decrypt private key with password

    C->>S: Ask for challenge
    S-->>C: Send challenge
    C->>C: Sign challenge with private key
    C->>S: Send signed challenge
    S->>S: Verify signature with public key